\HeaderA{weighted.hist}{Display a weighted histogram}{weighted.hist}
\keyword{misc}{weighted.hist}
\begin{Description}\relax
Calculate the counts of the weighted values in specified bins and 
optionally display either a frequency or density histogram.
\end{Description}
\begin{Usage}
\begin{verbatim}
 weighted.hist(x,w,breaks="Sturges",col=NULL,plot=TRUE,
 freq=TRUE,ylim,ylab=NULL,...)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] A vector of numeric values
\item[\code{w}] A vector of weights at least as long as x.
\item[\code{breaks}] The endpoints of the ranges into which to count the weighted
values.
\item[\code{col}] An optional vector of colors for the bars of the histogram.
\item[\code{plot}] Whether to plot a histogram.
\item[\code{freq}] Whether to plot counts or densities.
\item[\code{ylim}] The limits of the plot ordinate.
\item[\code{ylab}] Label for the ordinate.
\item[\code{...}] Additional arguments passed to \samp{\LinkA{barplot}{barplot}}.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
\samp{weighted.hist} calculates the weighted counts of values falling 
into the ranges specified by \samp{breaks}. Instead of counting each 
value as 1, it counts the corresponding value in \samp{w} (the weight).

\samp{breaks} may be specified by a monotonically increasing vector 
of numbers that are interpreted as the endpoints of the ranges, a 
single number representing the number of ranges desired or the name 
of the function to calculate the ranges (see \samp{\LinkA{hist}{hist}}).
If a vector of numbers is passed that does not include all values in 
\samp{x}, the user is warned. If the ranges are not equal, a warning 
will be displayed if \samp{freq} is TRUE or the heights of the bars 
will be adjusted to display areas approximately equal to the counts 
if \samp{freq} is FALSE.
\end{Details}
\begin{Value}
A list containing:

breaks - The endpoints of the intervals

counts - The weighted counts

density - The weighted counts divided by their sum.

mids - The midpoints of the intervals and the bars displayed.

xname - the name of \samp{x}.

equidist - Whether the intervals differ by less than the total range/1000.
\end{Value}
\begin{Author}\relax
Jim Lemon and Hadley Wickham
\end{Author}
\begin{SeeAlso}\relax
\samp{\LinkA{hist}{hist}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
 testx<-sample(1:10,300,TRUE)
 testw<-seq(1,4,by=0.01)
 weighted.hist(testx,testw,breaks=1:10,main="Test weighted histogram")
\end{ExampleCode}
\end{Examples}

